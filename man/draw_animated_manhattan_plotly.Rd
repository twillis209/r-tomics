% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/manhattan.R
\name{draw_animated_manhattan_plotly}
\alias{draw_animated_manhattan_plotly}
\title{Animate Manhattan plot transition using plotly}
\usage{
draw_animated_manhattan_plotly(
  processed_sumstats_before,
  processed_sumstats_after,
  stat_col = "p",
  p_threshold = 1,
  genome_wide_line = NULL,
  n_frames = 20,
  frame_duration = 100,
  transition_duration = 50,
  palette = c("#E69F00", "#56B4E9"),
  title = "Manhattan Plot Animation",
  point_size = 3
)
}
\arguments{
\item{processed_sumstats_before}{list containing data.table with processed
summary statistics for the "before" dataset}

\item{processed_sumstats_after}{list containing data.table with processed
summary statistics for the "after" dataset}

\item{stat_col}{character string containing the column name for the test
statistic to display}

\item{p_threshold}{numeric p-value threshold for filtering SNPs (default 1,
no filtering). SNPs with p > p_threshold in both before AND after datasets
are excluded to improve performance.}

\item{genome_wide_line}{numeric p-value for genome-wide significance line
(default NULL, no line). If provided, draws a dashed blue horizontal line.}

\item{n_frames}{integer number of intermediate frames to generate (default 20)}

\item{frame_duration}{integer milliseconds per frame (default 100)}

\item{transition_duration}{integer milliseconds for transitions between frames (default 50)}

\item{palette}{character vector containing colors for chromosomes}

\item{title}{character string containing the title for the plot}

\item{point_size}{numeric size of points (default 3)}
}
\value{
plotly object with animated Manhattan plot
}
\description{
Creates an interactive animated Manhattan plot showing the transition from
"before" to "after" datasets using plotly's animation framework. The animation
can be controlled with play/pause buttons.
}
\examples{
\dontrun{
library(data.table)

# Create example datasets
gwas_before <- data.table(
  chromosome = rep(1:22, each = 1000),
  base_pair_location = rep(1:1000, 22) * 10000,
  p_value = c(runif(500, 1e-10, 1e-6), runif(21500, 1e-3, 1))
)

gwas_after <- data.table(
  chromosome = rep(1:22, each = 1000),
  base_pair_location = rep(1:1000, 22) * 10000,
  p_value = c(runif(600, 1e-12, 1e-7), runif(21400, 1e-3, 1))
)

# Process datasets
sumstats_before <- process_sumstats_for_manhattan(gwas_before, stat_cols = "p_value")
sumstats_after <- process_sumstats_for_manhattan(gwas_after, stat_cols = "p_value")

# Create animated plot
fig <- draw_animated_manhattan_plotly(
  sumstats_before,
  sumstats_after,
  stat_col = "p_value",
  n_frames = 30,
  title = "GWAS Analysis: Before → After"
)
fig

# With p-value filtering for better performance
fig <- draw_animated_manhattan_plotly(
  sumstats_before,
  sumstats_after,
  stat_col = "p_value",
  p_threshold = 0.01,
  n_frames = 30,
  title = "GWAS Analysis: Before → After (filtered)"
)
fig

# With genome-wide significance line
fig <- draw_animated_manhattan_plotly(
  sumstats_before,
  sumstats_after,
  stat_col = "p_value",
  genome_wide_line = 5e-8,
  title = "GWAS Analysis with Significance Threshold"
)
fig

# Save to HTML
save_plotly_html(fig, "animated_manhattan.html")
}
}
\author{
Tom Willis
}
