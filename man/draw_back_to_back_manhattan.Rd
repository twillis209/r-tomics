% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/manhattan.R
\name{draw_back_to_back_manhattan}
\alias{draw_back_to_back_manhattan}
\title{Draw back-to-back Manhattan plots (mirrored)}
\usage{
draw_back_to_back_manhattan(
  processed_sumstats_top,
  processed_sumstats_bottom,
  stat_col = "p",
  palette = c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00",
    "#CC79A7"),
  title = "",
  y_limits = c(1, 1e-10),
  y_axis_breaks = 10^(-seq(0, 10, by = 1)),
  genome_wide_line = NULL,
  top_label = "Top",
  bottom_label = "Bottom",
  point_size = 0.3
)
}
\arguments{
\item{processed_sumstats_top}{list containing data.table with processed
summary statistics for the top Manhattan plot}

\item{processed_sumstats_bottom}{list containing data.table with processed
summary statistics for the bottom (reflected) Manhattan plot}

\item{stat_col}{character string containing the column name for the test
statistic to display}

\item{palette}{character vector containing colors for chromosomes}

\item{title}{character string containing the title for the plot}

\item{y_limits}{limits for y axis (applied to both plots)}

\item{y_axis_breaks}{numeric vector containing coordinates at which to place
breaks on the y-axis}

\item{genome_wide_line}{numeric p-value for genome-wide significance line
(default NULL, no line). If provided, draws dashed blue horizontal lines
on both top and bottom plots.}

\item{top_label}{character string label for the top plot (default "Top")}

\item{bottom_label}{character string label for the bottom plot (default "Bottom")}

\item{point_size}{numeric value for point size (default 0.3)}
}
\value{
ggplot2 object with back-to-back Manhattan plots
}
\description{
Creates two Manhattan plots stacked vertically with the bottom one reflected
(inverted) along the x-axis. Useful for comparing two GWAS datasets side by
side. Chromosome labels are omitted for clarity.
}
\examples{
\dontrun{
library(data.table)

# Create two example datasets
gwas_1 <- data.table(
  chromosome = rep(1:22, each = 1000),
  base_pair_location = rep(1:1000, 22) * 10000,
  p_value = c(runif(500, 1e-10, 1e-6), runif(21500, 1e-3, 1))
)

gwas_2 <- data.table(
  chromosome = rep(1:22, each = 1000),
  base_pair_location = rep(1:1000, 22) * 10000,
  p_value = c(runif(600, 1e-12, 1e-7), runif(21400, 1e-3, 1))
)

# Process both datasets
sumstats_1 <- process_sumstats_for_manhattan(gwas_1, stat_cols = "p_value")
sumstats_2 <- process_sumstats_for_manhattan(gwas_2, stat_cols = "p_value")

# Create back-to-back plot
draw_back_to_back_manhattan(
  sumstats_1,
  sumstats_2,
  stat_col = "p_value",
  title = "Comparison of Two GWAS",
  top_label = "Males",
  bottom_label = "Females"
)

# With genome-wide significance line
draw_back_to_back_manhattan(
  sumstats_1,
  sumstats_2,
  stat_col = "p_value",
  genome_wide_line = 5e-8,
  title = "Comparison with Significance Threshold",
  top_label = "Males",
  bottom_label = "Females"
)
}
}
\author{
Tom Willis
}
