% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/manhattan.R
\name{draw_superimposed_manhattan}
\alias{draw_superimposed_manhattan}
\title{Draw superimposed Manhattan plots (before and after comparison)}
\usage{
draw_superimposed_manhattan(
  processed_sumstats_before,
  processed_sumstats_after,
  stat_col = "p",
  alpha_before = 0.3,
  alpha_after = 1,
  palette_before = NULL,
  palette_after = NULL,
  palette = c("#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00",
    "#CC79A7"),
  title = "",
  y_limits = c(1, 1e-10),
  y_axis_breaks = 10^(-seq(0, 10, by = 1)),
  legend_labels = c("Before", "After"),
  point_size = 0.3
)
}
\arguments{
\item{processed_sumstats_before}{list containing data.table with processed
summary statistics for the "before" dataset (will be faded)}

\item{processed_sumstats_after}{list containing data.table with processed
summary statistics for the "after" dataset (will be solid)}

\item{stat_col}{character string containing the column name for the test
statistic to display}

\item{alpha_before}{numeric value between 0 and 1 for transparency of the
"before" dataset (default 0.3 for faded appearance)}

\item{alpha_after}{numeric value between 0 and 1 for transparency of the
"after" dataset (default 1.0 for solid appearance)}

\item{palette_before}{character vector containing colors for chromosomes in
the "before" dataset. If NULL, uses palette.}

\item{palette_after}{character vector containing colors for chromosomes in
the "after" dataset. If NULL, uses palette.}

\item{palette}{character vector containing colors for chromosomes (used for
both datasets if palette_before and palette_after are not specified)}

\item{title}{character string containing the title for the plot}

\item{y_limits}{limits for y axis}

\item{y_axis_breaks}{numeric vector containing coordinates at which to place
breaks on the y-axis}

\item{legend_labels}{character vector of length 2 with labels for the two
datasets (default c("Before", "After"))}

\item{point_size}{numeric value for point size (default 0.3)}
}
\value{
ggplot2 object with superimposed Manhattan plots
}
\description{
Creates a Manhattan plot with two datasets overlaid, typically representing
before and after analyses. The first dataset is drawn with reduced opacity
(faded) and the second with full or higher opacity (solid), making it easy
to compare changes between two analyses.
}
\examples{
\dontrun{
library(data.table)

# Create example GWAS data for "before" analysis
gwas_before <- data.table(
  chromosome = rep(1:22, each = 1000),
  base_pair_location = rep(1:1000, 22) * 10000,
  p_value = c(runif(500, 1e-10, 1e-6), runif(21500, 1e-3, 1))
)

# Create example GWAS data for "after" analysis with some improved signals
gwas_after <- data.table(
  chromosome = rep(1:22, each = 1000),
  base_pair_location = rep(1:1000, 22) * 10000,
  p_value = c(runif(600, 1e-12, 1e-7), runif(21400, 1e-3, 1))
)

# Process both datasets
sumstats_before <- process_sumstats_for_manhattan(
  gwas_before,
  stat_cols = "p_value"
)

sumstats_after <- process_sumstats_for_manhattan(
  gwas_after,
  stat_cols = "p_value"
)

# Create superimposed Manhattan plot with same palette
draw_superimposed_manhattan(
  sumstats_before,
  sumstats_after,
  stat_col = "p_value",
  alpha_before = 0.3,
  alpha_after = 1.0,
  title = "GWAS: Before vs After QC",
  legend_labels = c("Before QC", "After QC")
)

# Use distinct palettes for before and after
draw_superimposed_manhattan(
  sumstats_before,
  sumstats_after,
  stat_col = "p_value",
  alpha_before = 0.4,
  alpha_after = 0.8,
  palette_before = c("#E69F00", "#F0E442"),  # Orange/yellow tones
  palette_after = c("#0072B2", "#56B4E9"),   # Blue tones
  title = "GWAS: Before (warm) vs After (cool)"
)

# Customize appearance with distinct palettes
draw_superimposed_manhattan(
  sumstats_before,
  sumstats_after,
  stat_col = "p_value",
  alpha_before = 0.2,
  alpha_after = 0.8,
  point_size = 0.5,
  palette_before = c("gray60", "gray40"),
  palette_after = c("#D55E00", "#CC79A7"),
  y_limits = c(1, 1e-12),
  y_axis_breaks = c(1, 1e-3, 1e-6, 1e-9, 1e-12),
  title = "Comparison of Meta-Analysis Results"
)
}
}
\author{
Tom Willis
}
