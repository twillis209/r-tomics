% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/manhattan.R
\name{draw_plotly_manhattan}
\alias{draw_plotly_manhattan}
\title{Draw interactive plotly Manhattan plot for GWAS data}
\usage{
draw_plotly_manhattan(
  dat,
  chr_col = "chromosome",
  bp_col = "base_pair_location",
  p_col = "p_value",
  snp_col = NULL,
  chromosomes = as.character(1:22),
  region_chr = NULL,
  region_start = NULL,
  region_end = NULL,
  p_threshold = 1,
  palette = c("#E69F00", "#56B4E9"),
  title = "Manhattan Plot",
  genome_wide_line = 5e-08,
  suggestive_line = 1e-05,
  point_size = 3
)
}
\arguments{
\item{dat}{data.table containing summary statistics with columns for
chromosome, position, p-value, and optionally SNP ID}

\item{chr_col}{character string containing the column name for chromosome}

\item{bp_col}{character string containing the column name for position}

\item{p_col}{character string containing the column name for p-value}

\item{snp_col}{character string containing the column name for SNP ID (optional)}

\item{chromosomes}{character vector containing chromosomes to include in the plot}

\item{region_chr}{character string specifying a single chromosome to plot (optional).
If provided with region_start and region_end, only this region will be plotted.}

\item{region_start}{numeric start position in base pairs for region to plot (optional)}

\item{region_end}{numeric end position in base pairs for region to plot (optional)}

\item{p_threshold}{numeric p-value threshold for filtering SNPs (default 1,
no filtering). SNPs with p > p_threshold are excluded to improve performance.}

\item{palette}{character vector containing colors for chromosomes}

\item{title}{character string containing the title for the plot}

\item{genome_wide_line}{numeric p-value for genome-wide significance line
(default 5e-8)}

\item{suggestive_line}{numeric p-value for suggestive significance line
(default 1e-5)}

\item{point_size}{numeric size of points (default 3)}
}
\value{
plotly object with interactive Manhattan plot
}
\description{
Creates an interactive Manhattan plot using plotly that allows zooming and
panning to explore GWAS association signals. Includes optional p-value
filtering to improve performance with large datasets.
}
\examples{
\dontrun{
library(data.table)

# Create example GWAS data
gwas_data <- data.table(
  chromosome = rep(1:22, each = 10000),
  base_pair_location = rep(1:10000, 22) * 1000,
  p_value = runif(220000, 0, 1),
  snp_id = paste0("rs", 1:220000)
)

# Basic interactive Manhattan plot
fig <- draw_plotly_manhattan(
  dat = gwas_data,
  chr_col = "chromosome",
  bp_col = "base_pair_location",
  p_col = "p_value",
  title = "My GWAS Study"
)
fig

# With p-value filtering for better performance (only show p < 0.01)
fig <- draw_plotly_manhattan(
  dat = gwas_data,
  chr_col = "chromosome",
  bp_col = "base_pair_location",
  p_col = "p_value",
  snp_col = "snp_id",
  p_threshold = 0.01,
  title = "Filtered Manhattan Plot"
)
fig

# Customize colors and significance lines
fig <- draw_plotly_manhattan(
  dat = gwas_data,
  p_threshold = 0.001,
  palette = c("#1f77b4", "#ff7f0e"),
  genome_wide_line = 5e-8,
  suggestive_line = 1e-5,
  point_size = 4
)
fig

# Plot a specific region (e.g., chromosome 6, 25-35 Mb)
fig <- draw_plotly_manhattan(
  dat = gwas_data,
  region_chr = "6",
  region_start = 25000000,
  region_end = 35000000,
  title = "Chromosome 6: 25-35 Mb"
)
fig

# Save to HTML file for viewing in browser
fig <- draw_plotly_manhattan(dat = gwas_data, p_threshold = 0.01)
save_plotly_html(fig, "manhattan_plot.html")
}
}
\author{
Tom Willis
}
